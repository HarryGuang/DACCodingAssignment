{"ast":null,"code":"import { catchError } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/router\";\nimport * as i2 from \"ngx-toastr\";\nexport class ErrorInterceptor {\n  constructor(rooter, toastr) {\n    this.rooter = rooter;\n    this.toastr = toastr;\n  }\n  intercept(request, next) {\n    return next.handle(request).pipe(catchError(error => {\n      if (error) {\n        switch (error.status) {\n          case 400:\n            //console.log(Array.isArray(error.error));              \n            //if (error.error.errors) {\n            if (Array.isArray(error.error)) {\n              const modelStateErrors = [];\n              for (const key in error.error) {\n                if (error.error[key]) {\n                  modelStateErrors.push(error.error.errors[key]);\n                }\n              }\n              /*\r\n              for (const key in error.error) {\r\n                if (error.error.errors[key]) {\r\n                  modelStateErrors.push(error.error.errors[key]);\r\n                }\r\n              }\r\n              */\n              //console.log(modelStateErrors);\n              throw modelStateErrors.flat();\n            } else {\n              console.log(error.error);\n              this.toastr.error(error.error, error.status.toString());\n            }\n            break;\n          case 401:\n            this.toastr.error('Unauthorised', error.status.toString());\n            break;\n          case 404:\n            this.rooter.navigateByUrl('/not-found');\n            break;\n          case 500:\n            const navigationExtras = {\n              state: {\n                error: error.error\n              }\n            };\n            this.rooter.navigateByUrl('/server-error', navigationExtras);\n            break;\n          default:\n            this.toastr.error('Something unexpected went wrong');\n            console.log(error);\n            break;\n        }\n      }\n      throw error;\n    }));\n  }\n}\nErrorInterceptor.ɵfac = function ErrorInterceptor_Factory(t) {\n  return new (t || ErrorInterceptor)(i0.ɵɵinject(i1.Router), i0.ɵɵinject(i2.ToastrService));\n};\nErrorInterceptor.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n  token: ErrorInterceptor,\n  factory: ErrorInterceptor.ɵfac\n});","map":{"version":3,"mappings":"AAQA,SAASA,UAAU,QAAoB,MAAM;;;;AAK7C,OAAM,MAAOC,gBAAgB;EAC3BC,YAAoBC,MAAc,EAAUC,MAAqB;IAA7C,WAAM,GAAND,MAAM;IAAkB,WAAM,GAANC,MAAM;EAAkB;EAEpEC,SAAS,CACPC,OAA6B,EAC7BC,IAAiB;IAEjB,OAAOA,IAAI,CAACC,MAAM,CAACF,OAAO,CAAC,CAACG,IAAI,CAC9BT,UAAU,CAAEU,KAAwB,IAAI;MACtC,IAAIA,KAAK,EAAE;QACT,QAAQA,KAAK,CAACC,MAAM;UAClB,KAAK,GAAG;YACN;YACA;YACA,IAAIC,KAAK,CAACC,OAAO,CAACH,KAAK,CAACA,KAAK,CAAC,EAAE;cAC9B,MAAMI,gBAAgB,GAAG,EAAE;cAC3B,KAAK,MAAMC,GAAG,IAAIL,KAAK,CAACA,KAAK,EAAE;gBAC7B,IAAIA,KAAK,CAACA,KAAK,CAACK,GAAG,CAAC,EAAE;kBACpBD,gBAAgB,CAACE,IAAI,CAACN,KAAK,CAACA,KAAK,CAACO,MAAM,CAACF,GAAG,CAAC,CAAC;;;cAGlD;;;;;;;cAOA;cACA,MAAMD,gBAAgB,CAACI,IAAI,EAAE;aAC9B,MAAM;cACLC,OAAO,CAACC,GAAG,CAACV,KAAK,CAACA,KAAK,CAAC;cACxB,IAAI,CAACN,MAAM,CAACM,KAAK,CAACA,KAAK,CAACA,KAAK,EAAEA,KAAK,CAACC,MAAM,CAACU,QAAQ,EAAE,CAAC;;YAEzD;UACF,KAAK,GAAG;YACN,IAAI,CAACjB,MAAM,CAACM,KAAK,CAAC,cAAc,EAAEA,KAAK,CAACC,MAAM,CAACU,QAAQ,EAAE,CAAC;YAC1D;UACF,KAAK,GAAG;YACN,IAAI,CAAClB,MAAM,CAACmB,aAAa,CAAC,YAAY,CAAC;YACvC;UACF,KAAK,GAAG;YACN,MAAMC,gBAAgB,GAAqB;cACzCC,KAAK,EAAE;gBAAEd,KAAK,EAAEA,KAAK,CAACA;cAAK;aAC5B;YACD,IAAI,CAACP,MAAM,CAACmB,aAAa,CAAC,eAAe,EAAEC,gBAAgB,CAAC;YAC5D;UACF;YACE,IAAI,CAACnB,MAAM,CAACM,KAAK,CAAC,iCAAiC,CAAC;YACpDS,OAAO,CAACC,GAAG,CAACV,KAAK,CAAC;YAClB;QAAM;;MAGZ,MAAMA,KAAK;IACb,CAAC,CAAC,CACH;EACH;;AAxDWT,gBAAgB;mBAAhBA,gBAAgB;AAAA;AAAhBA,gBAAgB;SAAhBA,gBAAgB;EAAAwB,SAAhBxB,gBAAgB;AAAA","names":["catchError","ErrorInterceptor","constructor","rooter","toastr","intercept","request","next","handle","pipe","error","status","Array","isArray","modelStateErrors","key","push","errors","flat","console","log","toString","navigateByUrl","navigationExtras","state","factory"],"sourceRoot":"","sources":["D:\\Harry\\NetCore\\DACCodingAssignment\\DACCodingAssignment\\clientfront\\src\\app\\_interceptors\\error.interceptor.ts"],"sourcesContent":["import { Injectable } from '@angular/core';\nimport {\n  HttpRequest,\n  HttpHandler,\n  HttpEvent,\n  HttpInterceptor,\n  HttpErrorResponse,\n} from '@angular/common/http';\nimport { catchError, Observable } from 'rxjs';\nimport { NavigationExtras, Router } from '@angular/router';\nimport { ToastrService } from 'ngx-toastr';\n\n@Injectable()\nexport class ErrorInterceptor implements HttpInterceptor {\n  constructor(private rooter: Router, private toastr: ToastrService) {}\n\n  intercept(\n    request: HttpRequest<unknown>,\n    next: HttpHandler\n  ): Observable<HttpEvent<unknown>> {\n    return next.handle(request).pipe(\n      catchError((error: HttpErrorResponse) => {\n        if (error) {\n          switch (error.status) {\n            case 400:\n              //console.log(Array.isArray(error.error));              \n              //if (error.error.errors) {\n              if (Array.isArray(error.error)) {\n                const modelStateErrors = [];\n                for (const key in error.error) {\n                  if (error.error[key]) {\n                    modelStateErrors.push(error.error.errors[key]);\n                  }\n                }\n                /*\n                for (const key in error.error) {\n                  if (error.error.errors[key]) {\n                    modelStateErrors.push(error.error.errors[key]);\n                  }\n                }\n                */\n                //console.log(modelStateErrors);\n                throw modelStateErrors.flat();\n              } else {\n                console.log(error.error);\n                this.toastr.error(error.error, error.status.toString());\n              }\n              break;\n            case 401:\n              this.toastr.error('Unauthorised', error.status.toString());\n              break;\n            case 404:\n              this.rooter.navigateByUrl('/not-found');\n              break;\n            case 500:\n              const navigationExtras: NavigationExtras = {\n                state: { error: error.error },\n              };\n              this.rooter.navigateByUrl('/server-error', navigationExtras);\n              break;\n            default:\n              this.toastr.error('Something unexpected went wrong');\n              console.log(error);\n              break;\n          }\n        }\n        throw error;\n      })\n    );\n  }\n}\n"]},"metadata":{},"sourceType":"module","externalDependencies":[]}